library(tidyverse);
library(stringr);
#indir <- file.path("/home/ludmilla/Documents/uni_wuerzburg/phd_project/thesis/model/inputs")
indir <- file.path("/home/luf74xx/Dokumente/model/inputs"); #CCTBserver
inid <- file.path("singlespinput1.csv") # check in simID file in output
input <- as_tibble(read.table(file.path(indir, inid), header = TRUE, sep = ","))
#outdir <- file.path("/home/ludmilla/Documents/uni_wuerzburg/phd_project/thesis/model/EDoutputs") #CCTBserver
outdir <- file.path("/home/luf74xx/Dokumente/model/EDoutputs");
outid <- file.path("singlesp1-5y"); #simID
outraw <- as_tibble(read.table(file.path(outdir, outid, "orgsweekly.csv"), header = TRUE, sep = "\t"));
# very long file, since each organism gets a line
## parentheses from location ("()") and biomass ("()", "Dict", "=")+
loc <- gsub("[\\(|\\)]", "", outraw$location)
## split location in 3 columns
loc <- as.data.frame(matrix(unlist(str_split(loc, ",")),ncol =3,byrow = T))
names(loc) = c("xloc", "yloc", "floc")
## get vegetative and reproductive biomasses. When no reproductive biomass, adds 0 before reshaping 2 columns
masses = c()
for(plant in outraw$biomass){
m <- unlist(str_extract_all(plant,"([0-9]{1,4}.[0-9]{1,7})")) # extracts both veg and repr
if(length(m) < 2){
m <- c(0,m)
}
masses <- rbind(masses,m)
}
masses <- as.data.frame(masses, stringsAsFactors = FALSE); #there is probably a better way to convert into numeric
masses <- as.data.frame(sapply(masses, as.numeric));
names(masses) <-c("repr", "veg");
## Complete and clean table
outdata <- as_tibble(cbind(select(outraw,-one_of("location","biomass")),
loc,
masses))
rm(masses, loc, plant, m)
biomass <- outdata %>%
select(week,id,sp,veg,repr)
#Individual biomass variation
indweekmass.plot <- ggplot(biomass, aes(x=week, y= veg, color = factor(id)))
indweekmass.plot +
geom_line() +
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Individual biomass")+
theme(legend.position = "bottom")
production <- biomass %>%
mutate(total = veg+repr) %>%
group_by(week,id)
ind1 = diff(production$total[which(production$id == "p1-1")],lag = 1)
ind2 = diff(production$total[which(production$id == "p1-2")],lag = 1)
plot(ind1, type = "l", ylab = "Production (g)", xlab = "Week", main ="Individual biomass production")
lines(ind2, type = "l", col ="red")
legend("topleft", c("ind1","ind2"), fill =c("black","red"))
#indir <- file.path("/home/ludmilla/Documents/uni_wuerzburg/phd_project/thesis/model/inputs")
indir <- file.path("/home/luf74xx/Dokumente/model/inputs"); #CCTBserver
inid <- file.path("singlespinput1.csv") # check in simID file in output
input <- as_tibble(read.table(file.path(indir, inid), header = TRUE, sep = ","))
#outdir <- file.path("/home/ludmilla/Documents/uni_wuerzburg/phd_project/thesis/model/EDoutputs") #CCTBserver
outdir <- file.path("/home/luf74xx/Dokumente/model/EDoutputs");
outid <- file.path("singlesp1-5y"); #simID
outraw <- as_tibble(read.table(file.path(outdir, outid, "orgsweekly.csv"), header = TRUE, sep = "\t"));
# very long file, since each organism gets a line
## parentheses from location ("()") and biomass ("()", "Dict", "=")+
loc <- gsub("[\\(|\\)]", "", outraw$location)
## split location in 3 columns
loc <- as.data.frame(matrix(unlist(str_split(loc, ",")),ncol =3,byrow = T))
names(loc) = c("xloc", "yloc", "floc")
## get vegetative and reproductive biomasses. When no reproductive biomass, adds 0 before reshaping 2 columns
masses = c()
for(plant in outraw$biomass){
m <- unlist(str_extract_all(plant,"([0-9]{1,4}.[0-9]{1,7})")) # extracts both veg and repr
if(length(m) < 2){
m <- c(0,m)
}
masses <- rbind(masses,m)
}
masses <- as.data.frame(masses, stringsAsFactors = FALSE); #there is probably a better way to convert into numeric
masses <- as.data.frame(sapply(masses, as.numeric));
names(masses) <-c("repr", "veg");
## Complete and clean table
outdata <- as_tibble(cbind(select(outraw,-one_of("location","biomass")),
loc,
masses))
rm(masses, loc, plant, m)
temperature <- as_tibble(read.csv(file.path(indir,"envtimeseries_1999.csv"), header =TRUE))
ggplot(temperature, aes(x=week, y =meantemp_ts))+
geom_line()+
labs(x = "Week", y = "Temperature (°C, monthly)",
title = "Annual temperature variation during 1999")
temperature <- as_tibble(read.csv(file.path(indir,"envtimeseries_19995y.csv"), header =TRUE))
ggplot(temperature, aes(x=week, y =meantemp_ts))+
geom_line()+
labs(x = "Week", y = "Temperature (°C, monthly)",
title = "Annual temperature variation")
biomass <- outdata %>%
select(week,id,sp,veg,repr)
#Individual biomass variation
indweekmass.plot <- ggplot(biomass, aes(x=week, y= veg, color = factor(id)))
indweekmass.plot +
geom_line() +
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Individual biomass")+
theme(legend.position = "bottom")
production <- biomass %>%
mutate(total = veg+repr) %>%
group_by(week,id)
ind1 = diff(production$total[which(production$id == "p1-1")],lag = 1)
ind2 = diff(production$total[which(production$id == "p1-2")],lag = 1)
plot(ind1, type = "l", ylab = "Production (g)", xlab = "Week", main ="Individual biomass production")
lines(ind2, type = "l", col ="red")
legend("topleft", c("ind1","ind2"), fill =c("black","red"))
# Species-specific biomass production
spproduction <- biomass%>%
group_by(week, sp) %>%
summarise(veg.mean = mean(veg), veg.sd = sd(veg), repr.mean = mean(repr), repr.sd = sd(repr))
spproduction.plot <- ggplot(spproduction, aes(x=week, y= veg.mean, color = factor(sp)))
spproduction.plot +
geom_line() +
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Mean vegetative biomass (+-sd) per species")+
theme(legend.position = "none")
indrepmass.plot <- ggplot(biomass, aes(x=week, y= repr, color = factor(id)))
indrepmass.plot +
geom_line() +
labs(x = "Week", y = "Total reproductive biomass (g)",
title = "Individual reproductive biomass variation")+
theme(legend.position = "bottom")
sprepmass.plot <- ggplot(biomass, aes(x=week, y= repr, color = factor(sp)))
sprepmass.plot +
geom_line() +
labs(x = "Week", y = "Mean reproductive biomass (g)",
title = "Annual reproductive biomass variation",
subtitle = "Mean reproductive biomass (+-sd) per species")+
theme(legend.position = "none")
indsize <- outdata %>%
group_by(week, id) %>%
summarise(rad.mean = 3*(radius+1)) #each cell is 3x3cm², plus central cell, to which the radius is added
indsize.plot <- ggplot(indsize, aes(x=week, y=rad.mean, color = factor(id)))
indsize.plot +
geom_line() +
labs(x = "Week", y = "Radius (cm)",
title = "Plant size variation (cm) ",
subtitle = "Individual radius")+
theme(legend.position = "bottom")
biomass <- outdata %>%
select(week,id,stage,sp,veg,repr)
biomass <- outdata %>%
select(week,id,stage,sp,veg,repr)
#Individual biomass variation
indweekmass.plot <- ggplot(filter(biomass, stage == "a"), aes(x=week, y= veg, color = factor(id)))
indweekmass.plot +
geom_line() +
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Individual biomass")+
theme(legend.position = "bottom")
production <- biomass %>%
mutate(total = veg+repr) %>%
group_by(week,id)
ind1 = diff(production$total[which(production$id == "p1-1")],lag = 1)
ind2 = diff(production$total[which(production$id == "p1-2")],lag = 1)
plot(ind1, type = "l", ylab = "Production (g)", xlab = "Week", main ="Individual biomass production")
lines(ind2, type = "l", col ="red")
legend("topleft", c("ind1","ind2"), fill =c("black","red"))
# Species-specific biomass production
spproduction <- biomass%>%
group_by(week, sp) %>%
summarise(veg.mean = mean(veg), veg.sd = sd(veg), repr.mean = mean(repr), repr.sd = sd(repr))
spproduction.plot <- ggplot(spproduction, aes(x=week, y= veg.mean, color = factor(sp)))
pd <- position_dodge(0.1) # move them .05 to the left and right
spproduction.plot +
geom_line() +
geom_errorbar(aes(ymin=veg.mean-veg.sd, ymax=veg.mean+veg.sd), width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)+
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Mean vegetative biomass (+-sd) per species")+
theme(legend.position = "none")
View(spproduction)
spproduction <- biomass%>%
group_by(week, sp, stage) %>%
summarise(veg.mean = mean(veg), veg.sd = sd(veg), repr.mean = mean(repr), repr.sd = sd(repr))
View(spproduction)
spproduction.plot <- ggplot(spproduction, aes(x=week, y= veg.mean, color = factor(stage))) #only one sp
pd <- position_dodge(0.1) # move them .05 to the left and right
spproduction.plot +
geom_line() +
geom_errorbar(aes(ymin=veg.mean-veg.sd, ymax=veg.mean+veg.sd), width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)+
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Mean vegetative biomass (+-sd) per species")+
theme(legend.position = "none")
spproduction.plot +
geom_line() +
geom_errorbar(aes(ymin=veg.mean-veg.sd, ymax=veg.mean+veg.sd), colour = "black", width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)+
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Mean vegetative biomass (+-sd) per species")+
theme(legend.position = "none")
ggplot(spproduction, aes(x=week, y= veg.mean, color = factor(stage))) +
geom_line() +
geom_errorbar(aes(ymin=veg.mean-veg.sd, ymax=veg.mean+veg.sd), colour = "black", width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)+
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Mean vegetative biomass (+-sd) per species")+
theme(legend.position = "none")
ggplot(filter(spproduction,stage =="a"), aes(x=week, y= veg.mean, color = factor(stage))) +
geom_line() +
geom_errorbar(aes(ymin=veg.mean-veg.sd, ymax=veg.mean+veg.sd), colour = "black", width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)+
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Mean vegetative biomass (+-sd) per species")+
theme(legend.position = "none")
ggplot(filter(spproduction,stage =="a"), aes(x=week, y= veg.mean, color = factor(stage))) +
geom_line() +
# geom_errorbar(aes(ymin=veg.mean-veg.sd, ymax=veg.mean+veg.sd), colour = "black", width=.1, position=pd) +
# geom_line(position=pd) +
# geom_point(position=pd)+
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Mean vegetative biomass (+-sd) per species")+
theme(legend.position = "none")
weekabund <- outdata %>% group_by(week, sp) %>% summarize(abundance = n())
weekabund.plot <- ggplot(weekabund, aes(x = week, y = abundance, color = factor(sp)))
weekabund.plot +
geom_line() + #TODO differentiate species with colorgeom_line(color = "forestgreen")
labs(x = "Week", y = "Abundance (n individuals)",
title = "Abundance variation",
subtitle = "Species abundance per week")+
theme(legend.position = "none")
View(weekabund)
View(outdata)
#indir <- file.path("/home/ludmilla/Documents/uni_wuerzburg/phd_project/thesis/model/inputs")
indir <- file.path("/home/luf74xx/Dokumente/model/inputs"); #CCTBserver
inid <- file.path("singlespinput1.csv") # check in simID file in output
input <- as_tibble(read.table(file.path(indir, inid), header = TRUE, sep = ","))
#outdir <- file.path("/home/ludmilla/Documents/uni_wuerzburg/phd_project/thesis/model/EDoutputs") #CCTBserver
outdir <- file.path("/home/luf74xx/Dokumente/model/EDoutputs");
outid <- file.path("singlesp1-5ycheckrep"); #simID
outraw <- as_tibble(read.table(file.path(outdir, outid, "orgsweekly.csv"), header = TRUE, sep = "\t"));
# very long file, since each organism gets a line
## parentheses from location ("()") and biomass ("()", "Dict", "=")+
loc <- gsub("[\\(|\\)]", "", outraw$location)
## split location in 3 columns
loc <- as.data.frame(matrix(unlist(str_split(loc, ",")),ncol =3,byrow = T))
names(loc) = c("xloc", "yloc", "floc")
## get vegetative and reproductive biomasses. When no reproductive biomass, adds 0 before reshaping 2 columns
masses = c()
for(plant in outraw$biomass){
m <- unlist(str_extract_all(plant,"([0-9]{1,4}.[0-9]{1,7})")) # extracts both veg and repr
if(length(m) < 2){
m <- c(0,m)
}
masses <- rbind(masses,m)
}
masses <- as.data.frame(masses, stringsAsFactors = FALSE); #there is probably a better way to convert into numeric
masses <- as.data.frame(sapply(masses, as.numeric));
names(masses) <-c("repr", "veg");
## Complete and clean table
outdata <- as_tibble(cbind(select(outraw,-one_of("location","biomass")),
loc,
masses))
rm(masses, loc, plant, m)
biomass <- outdata %>%
select(week,id,stage,sp,veg,repr)
#Individual biomass variation
indweekmass.plot <- ggplot(filter(biomass, stage == "a"), aes(x=week, y= veg, color = factor(id)))
indweekmass.plot +
geom_line() +
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Individual biomass")+
theme(legend.position = "bottom")
production <- biomass %>%
mutate(total = veg+repr) %>%
group_by(week,id)
ind1 = diff(production$total[which(production$id == "p1-1")],lag = 1)
ind2 = diff(production$total[which(production$id == "p1-2")],lag = 1)
plot(ind1, type = "l", ylab = "Production (g)", xlab = "Week", main ="Individual biomass production")
lines(ind2, type = "l", col ="red")
legend("topleft", c("ind1","ind2"), fill =c("black","red"))
indrepmass.plot <- ggplot(biomass, aes(x=week, y= repr, color = factor(id)))
indrepmass.plot +
geom_line() +
labs(x = "Week", y = "Total reproductive biomass (g)",
title = "Individual reproductive biomass variation")+
theme(legend.position = "bottom")
sprepmass.plot <- ggplot(biomass, aes(x=week, y= repr, color = factor(sp)))
sprepmass.plot +
geom_line() +
labs(x = "Week", y = "Mean reproductive biomass (g)",
title = "Annual reproductive biomass variation",
subtitle = "Mean reproductive biomass (+-sd) per species")+
theme(legend.position = "none")
weekabund <- outdata %>% group_by(week, sp) %>% summarize(abundance = n())
weekabund.plot <- ggplot(weekabund, aes(x = week, y = abundance, color = factor(sp)))
weekabund.plot +
geom_line() + #TODO differentiate species with colorgeom_line(color = "forestgreen")
labs(x = "Week", y = "Abundance (n individuals)",
title = "Abundance variation",
subtitle = "Species abundance per week")+
theme(legend.position = "none")
production <- biomass %>%
mutate(total = veg+repr) %>%
group_by(week,id)
ind1 = diff(production$total[which(production$id == "p1-1")],lag = 1)
ind2 = diff(production$total[which(production$id == "p1-2")],lag = 1)
plot(ind1, type = "l", ylab = "Production (g)", xlab = "Week", main ="Individual biomass production")
lines(ind2, type = "l", col ="red")
legend("topleft", c("ind1","ind2"), fill =c("black","red"))
#indir <- file.path("/home/ludmilla/Documents/uni_wuerzburg/phd_project/thesis/model/inputs")
indir <- file.path("/home/luf74xx/Dokumente/model/inputs"); #CCTBserver
inid <- file.path("singlespinput1.csv") # check in simID file in output
input <- as_tibble(read.table(file.path(indir, inid), header = TRUE, sep = ","))
#outdir <- file.path("/home/ludmilla/Documents/uni_wuerzburg/phd_project/thesis/model/EDoutputs") #CCTBserver
outdir <- file.path("/home/luf74xx/Dokumente/model/EDoutputs");
outid <- file.path("singlesp1-5ycheckrep"); #simID
outraw <- as_tibble(read.table(file.path(outdir, outid, "orgsweekly.csv"), header = TRUE, sep = "\t"));
# very long file, since each organism gets a line
## parentheses from location ("()") and biomass ("()", "Dict", "=")+
loc <- gsub("[\\(|\\)]", "", outraw$location)
## split location in 3 columns
loc <- as.data.frame(matrix(unlist(str_split(loc, ",")),ncol =3,byrow = T))
names(loc) = c("xloc", "yloc", "floc")
## get vegetative and reproductive biomasses. When no reproductive biomass, adds 0 before reshaping 2 columns
masses = c()
for(plant in outraw$biomass){
m <- unlist(str_extract_all(plant,"([0-9]{1,4}.[0-9]{1,7})")) # extracts both veg and repr
if(length(m) < 2){
m <- c(0,m)
}
masses <- rbind(masses,m)
}
masses <- as.data.frame(masses, stringsAsFactors = FALSE); #there is probably a better way to convert into numeric
masses <- as.data.frame(sapply(masses, as.numeric));
names(masses) <-c("repr", "veg");
## Complete and clean table
outdata <- as_tibble(cbind(select(outraw,-one_of("location","biomass")),
loc,
masses))
rm(masses, loc, plant, m)
biomass <- outdata %>%
select(week,id,stage,sp,veg,repr)
#Individual biomass variation
indweekmass.plot <- ggplot(filter(biomass, stage == "a"), aes(x=week, y= veg, color = factor(id)))
indweekmass.plot +
geom_line() +
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Individual biomass")+
theme(legend.position = "bottom")
# Species-specific biomass production
spproduction <- biomass%>%
group_by(week, sp, stage) %>%
summarise(veg.mean = mean(veg), veg.sd = sd(veg), repr.mean = mean(repr), repr.sd = sd(repr))
spproduction.plot <- ggplot(spproduction, aes(x=week, y= veg.mean, color = factor(sp))) #only one sp, not necessary
pd <- position_dodge(0.1) # move them .05 to the left and right
ggplot(filter(spproduction,stage =="a"), aes(x=week, y= veg.mean, color = factor(stage))) +
geom_line() +
geom_errorbar(aes(ymin=veg.mean-veg.sd, ymax=veg.mean+veg.sd), colour = "black", width=.1, position=pd) +
geom_line(position=pd) +
geom_point(position=pd)+
labs(x = "Week", y = "Mean vegetative biomass (g)",
title = "Annual biomass variation",
subtitle = "Mean vegetative biomass (+-sd) per species")+
theme(legend.position = "none")
indrepmass.plot <- ggplot(biomass, aes(x=week, y= repr, color = factor(id)))
indrepmass.plot +
geom_line() +
labs(x = "Week", y = "Total reproductive biomass (g)",
title = "Individual reproductive biomass variation")+
theme(legend.position = "bottom")
weekabund <- outdata %>% group_by(week, sp) %>% summarize(abundance = n())
weekabund.plot <- ggplot(weekabund, aes(x = week, y = abundance, color = factor(sp)))
weekabund.plot +
geom_line() + #TODO differentiate species with colorgeom_line(color = "forestgreen")
labs(x = "Week", y = "Abundance (n individuals)",
title = "Abundance variation",
subtitle = "Species abundance per week")+
theme(legend.position = "none")
